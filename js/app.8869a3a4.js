(function(){"use strict";var e={7214:function(e,t,a){var n=a(6163);t["Z"]={signIn({account:e,password:t}){return n.l9.post("/signin",{account:e,password:t})},signUp(e){return n.l9.post("/signup",e)}}},292:function(e,t,a){var n=a(9242),o=a(3396);const s={id:"attendance-management-platform-api",class:"h-100"},r={role:"main",class:"h-100"};function c(e,t,a,n,c,l){const i=(0,o.up)("AppNavbar"),u=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(i),(0,o._)("main",r,[(0,o.Wm)(u)])])}var l=a(7139);const i={class:"navbar navbar-expand-lg fixed-top navbar-light bg-light"},u={class:"container-fluid"},d=(0,o._)("i",{class:"fa-solid fa-industry fa-xl mr-2"},null,-1),m=(0,o._)("strong",null," Attendance Management Platform ",-1),p=(0,o._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,o._)("span",{class:"navbar-toggler-icon"})],-1),g={id:"navbarSupportedContent",class:"collapse navbar-collapse d-lg-flex justify-content-end align-items-center ml-auto"},f={class:"navbar-nav ml-auto"},v=(0,o._)("i",{class:"fa-solid fa-screwdriver-wrench fa-bounce fa-2xl"},null,-1),b=(0,o._)("i",{class:"fa-solid fa-right-from-bracket fa-2xl text-muted"},null,-1),h=[b];function w(e,t,a,n,s,r){const c=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("nav",i,[(0,o._)("div",u,[(0,o.Wm)(c,{class:"navbar-brand m-3 text-primary",style:{"font-size":"36px"},to:"/"},{default:(0,o.w5)((()=>[d,m])),_:1}),e.isAuthenticated?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[p,(0,o._)("div",g,[(0,o._)("div",f,["admin"===e.currentUser.role?((0,o.wg)(),(0,o.j4)(c,{key:0,to:"/admin",class:"nav-item active text-muted m-3 text-decoration-none"},{default:(0,o.w5)((()=>[v])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(c,{to:"",class:"nav-item active text-primary text-center m-3 text-decoration-none",style:{"font-size":"24px"}},{default:(0,o.w5)((()=>[(0,o._)("strong",null," Hello, "+(0,l.zw)(e.currentUser.name||"User"),1)])),_:1}),(0,o._)("button",{type:"button",class:"btn nav-item m-3 my-sm-0",onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e))},h)])])],64)):(0,o.kq)("",!0)])])}a(7658);var y=a(65),k=a(2483),x={computed:{...(0,y.rn)(["currentUser","isAuthenticated"])},setup(){const e=(0,k.tv)(),t=(0,y.oR)();function a(){t.commit("revokeAuthentication"),localStorage.removeItem("clockedIn"),localStorage.removeItem("clockInTime"),localStorage.removeItem("clockOutTime"),localStorage.removeItem("dayChangeTime"),localStorage.removeItem("date"),e.push("/signin")}return{logout:a}}},_=a(89);const I=(0,_.Z)(x,[["render",w]]);var D=I,A={name:"attendance-management-platform-api",components:{AppNavbar:D}};const S=(0,_.Z)(A,[["render",c]]);var T=S,Y=a(6163),C={getCurrentUser(){return Y.l9.get("/get_current_user")},putProfile({UserId:e,formData:t}){return Y.l9.put(`/clocking/user/${e}/edit`,t)}},H=(0,y.MT)({state:{currentUser:{id:-1,name:"",email:"",account:"",role:""},isAuthenticated:!1,token:"",date:"",clockInTime:"",clockOutTime:"",clockedIn:!1},getters:{userId:e=>e.currentUser.id},mutations:{setCurrentUser(e,t){e.currentUser={...e.currentUser,...t},e.token=localStorage.getItem("token"),e.isAuthenticated=!0},revokeAuthentication(e){e.currentUser={},e.isAuthenticated=!1,e.token="",localStorage.removeItem("token")},setClockedIn(e,t){e.clockedIn=t},setClockInTime(e,t){e.clockInTime=t},setClockOutTime(e,t){e.clockOutTime=t},updateUserForm(e,t){e.currentUser={...e.currentUser,...t}}},actions:{async fetchCurrentUser({commit:e}){try{const{data:t}=await C.getCurrentUser(),{id:a,name:n,email:o,account:s,role:r}=t;return e("setCurrentUser",{id:a,name:n,email:o,account:s,role:r}),!0}catch(t){return console.error("can not fetch user information"),e("revokeAuthentication"),!1}}},modules:{}});function U(e,t){return(0,o.wg)(),(0,o.iD)("h1",null,"404 Page Not Found")}const z={},P=(0,_.Z)(z,[["render",U]]);var O=P;const M={class:"container card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"800px","margin-top":"200px"}},j=(0,o._)("div",{class:"d-flex justify-content-center text-center mb-4"},[(0,o._)("i",{class:"fa-solid fa-industry fa-2xl m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," Sign In ")])],-1),N={class:"form-label-group m-auto text-muted text-start mb-2",style:{"font-size":"24px"}},F=(0,o._)("label",{for:"account"},[(0,o._)("strong",null," Account ")],-1),q={class:"form-label-group m-auto text-muted text-start mb-3",style:{"font-size":"24px"}},Z=(0,o._)("label",{for:"password"},[(0,o._)("strong",null," Password ")],-1),L={class:"d-flex justify-content-center p-0",style:{"margin-top":"50px"}},E=["disabled"],R=(0,o._)("strong",null," Submit ",-1),W=[R],V={class:"text-center mt-3"},Q=(0,o._)("strong",null," Sign Up ",-1),G=(0,o._)("p",{class:"mt-5 mb-3 text-muted text-center",style:{"font-size":"16px"}}," © 2022-2023 ",-1);function $(e,t,a,s,r,c){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",M,[(0,o._)("form",{class:"w-50 col-md-8 text-primary m-auto",onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>s.handleSubmit&&s.handleSubmit(...e)),["prevent","stop"]))},[j,(0,o._)("div",N,[F,(0,o.wy)((0,o._)("input",{id:"account","onUpdate:modelValue":t[0]||(t[0]=e=>s.account=e),name:"account",type:"text",class:"form-control",placeholder:"account",autocomplete:"username",required:"",autofocus:""},null,512),[[n.nr,s.account]])]),(0,o._)("div",q,[Z,(0,o.wy)((0,o._)("input",{id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),name:"password",type:"password",class:"form-control",placeholder:"password",autocomplete:"current-password",required:""},null,512),[[n.nr,s.password]])]),(0,o._)("div",L,[(0,o._)("button",{class:"btn btn-lg btn-primary btn-block mb-3",type:"submit",disabled:s.isProcessing,style:{"font-size":"24px",width:"200px"}},W,8,E)]),(0,o._)("div",V,[(0,o._)("p",null,[(0,o.Wm)(l,{to:"/signup",class:"text-primary",style:{"font-size":"24px"}},{default:(0,o.w5)((()=>[Q])),_:1})])]),G],32)])}var J=a(4870),B=a(7214),K={setup(){const e=(0,J.iH)(""),t=(0,J.iH)(""),a=(0,J.iH)(!1),n=(0,k.tv)(),o=(0,y.oR)();async function s(){if(this.account&&this.password){this.isProcessing=!0;try{const e=await B.Z.signIn({account:this.account,password:this.password}),{data:t}=e;if("error"===t.status)throw new Error(t.message);localStorage.setItem("token",t.token),o.commit("setCurrentUser",t.user),n.push("/clocking"),Y.FN.fire({icon:"success",title:"登入成功！"})}catch(e){this.password="",this.isProcessing=!1,Y.FN.fire({icon:"warning",title:e.message}),console.log("error",e)}}else Y.FN.fire({icon:"warning",title:"請輸入帳號密碼！"})}return{account:e,password:t,handleSubmit:s,isProcessing:a}}};const X=(0,_.Z)(K,[["render",$]]);var ee=X;const te={class:"row vh-100",style:{"margin-top":"110px"}},ae={class:"col-xl-10 col-md-10 col-10 mt-5 text-center"},ne={class:"container-field card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"1000px","margin-left":"55px","margin-right":"55px"}};function oe(e,t,a,n,s,r){const c=(0,o.up)("AsideTabs"),l=(0,o.up)("ClockingView");return(0,o.wg)(),(0,o.iD)("div",te,[(0,o.Wm)(c,{class:"h-100"}),(0,o._)("div",ae,[(0,o._)("div",ne,[(0,o.Wm)(l)])])])}const se={class:"col-xl-2 col-md-2 col-2 text-center",style:{"background-color":"#14597f"}},re={class:"navbar-nav p-0"},ce={class:"title"},le={class:"fontawesome text-center m-auto",style:{width:"150px"}},ie={class:"fs-4 m-1"};function ue(e,t,a,n,s,r){const c=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("aside",se,[(0,o._)("ul",re,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.tabs,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.id,class:"nav-item text-white m-4",style:{"text-decoration":"none"}},[(0,o.Wm)(c,{to:e.path,class:"nav-link d-flex justify-content-between"},{default:(0,o.w5)((()=>[(0,o._)("div",ce,[(0,o._)("i",{class:(0,l.C_)(e.fontawesome),style:{width:"100px"}},null,2)]),(0,o._)("div",le,[(0,o._)("strong",ie,(0,l.zw)(e.title),1)])])),_:2},1032,["to"])])))),128))])])}var de=a(536),me={setup(){const e=(0,y.oR)(),t=e.getters.userId,a=(0,J.qj)([{id:(0,de.Z)(),title:"Clocking",path:"/clocking",fontawesome:"fa-solid fa-user-clock fa-3x"},{id:(0,de.Z)(),title:"QRCode",path:"/clocking/qrcode/generator",fontawesome:"fa-solid fa-qrcode fa-3x"},{id:(0,de.Z)(),title:"GPS",path:"/clocking/gps",fontawesome:"fa-solid fa-location-dot fa-3x"},{id:(0,de.Z)(),title:"Profile",path:`/clocking/user/${t}`,fontawesome:"fa-solid fa-address-card fa-3x"}]);return{tabs:a}}};const pe=(0,_.Z)(me,[["render",ue]]);var ge=pe;const fe={key:1},ve=(0,o._)("div",{class:"d-flex justify-content-center text-center text-primary mb-4"},[(0,o._)("i",{class:"fa-solid fa-user-clock fa-3x m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," Clocking Page ")])],-1),be={class:"my-3"},he={class:"my-3 d-grid gap-2 col-4 mx-auto"},we=["disabled"],ye=(0,o._)("h3",{class:"mb-0"},"打卡上班",-1),ke=[ye],xe=["disabled"],_e=(0,o._)("h3",{class:"mb-0"},"打卡下班",-1),Ie=[_e],De={class:"my-3 card d-flex justify-content-between align-items-center",style:{border:"none","font-size":"24px"}},Ae={class:"list-group"},Se={class:"list-group-item"},Te={key:0,class:"badge bg-primary rounded-pill"},Ye={key:1,class:"badge bg-secondary rounded-pill"},Ce={class:"list-group-item"},He={key:0,class:"badge bg-primary rounded-pill"},Ue={key:1,class:"badge bg-secondary rounded-pill"};function ze(e,t,a,n,s,r){const c=(0,o.up)("AppSpinner");return n.isLoading?((0,o.wg)(),(0,o.j4)(c,{key:0})):((0,o.wg)(),(0,o.iD)("div",fe,[ve,(0,o._)("h3",be,"現在時間："+(0,l.zw)(n.currentTime),1),(0,o._)("div",he,[n.clockedIn?((0,o.wg)(),(0,o.iD)("button",{key:1,disabled:n.isProcessing,onClick:t[1]||(t[1]=(...e)=>n.clockOut&&n.clockOut(...e)),class:"btn btn-success btn-circle"},Ie,8,xe)):((0,o.wg)(),(0,o.iD)("button",{key:0,disabled:n.isProcessing,onClick:t[0]||(t[0]=(...e)=>n.clockIn&&n.clockIn(...e)),class:"btn btn-danger btn-circle"},ke,8,we))]),(0,o._)("div",De,[(0,o._)("ul",Ae,[(0,o._)("li",Se,[(0,o.Uk)(" 上班時間： "),n.clockInTime?((0,o.wg)(),(0,o.iD)("span",Te,(0,l.zw)(n.clockInTime),1)):((0,o.wg)(),(0,o.iD)("span",Ye,"-"))]),(0,o._)("li",Ce,[(0,o.Uk)(" 下班時間： "),n.clockOutTime?((0,o.wg)(),(0,o.iD)("span",He,(0,l.zw)(n.clockOutTime),1)):((0,o.wg)(),(0,o.iD)("span",Ue,"-"))])])])]))}const Pe=e=>((0,o.dD)("data-v-fa02bac6"),e=e(),(0,o.Cn)(),e),Oe={class:"spinner"},Me=Pe((()=>(0,o._)("div",{class:"bouncing-loader"},[(0,o._)("div"),(0,o._)("div"),(0,o._)("div")],-1))),je=[Me];function Ne(e,t){return(0,o.wg)(),(0,o.iD)("div",Oe,je)}const Fe={},qe=(0,_.Z)(Fe,[["render",Ne],["__scopeId","data-v-fa02bac6"]]);var Ze=qe,Le={getAttendance(){return Y.l9.get("/attendance")},postAttendance({UserId:e,date:t,clockIn:a}){return Y.l9.post("/attendance",{UserId:e,date:t,clockIn:a})},updateAttendance({UserId:e,date:t,clockOut:a}){return Y.l9.put(`/attendance/${e}`,{UserId:e,date:t,clockOut:a})}},Ee=a(5743),Re=a.n(Ee),We=a(922),Ve=a.n(We),Qe=a(9311),Ge=a.n(Qe);Re().extend(Ve(),Ge());var $e={components:{AppSpinner:Ze},setup(){const e=(0,y.oR)(),t=(0,J.iH)(""),a=(0,J.iH)(Re()().format("YYYY-MM-DD")),n=localStorage.getItem("dayChangeTime"),o=localStorage.getItem("clockedIn"),s=(0,Y.uA)(o,e.state.clockedIn),r=(0,J.iH)(""),c=(0,J.iH)(""),l=(0,J.iH)(n),i=(0,J.iH)(!1),u=(0,J.iH)(!1),d=(0,J.iH)(s);async function m(){try{i.value=!0,u.value=!0;const{data:t}=await Le.getAttendance({UserId:e.getters.userId,date:a.value});t.data?(r.value=t.data.clockIn,c.value=t.data.clockOut,d.value=!0,await f(t.message,t.status)):(d.value=!1,await f("今日尚未執行考勤作業！","error")),i.value=!1,u.value=!1}catch(t){await f(t.message,"error")}}async function p(){i.value=!0,u.value=!0,d.value=!0,r.value=Re().utc().local().format("YYYY-MM-DD HH:mm:ss"),e.commit("setClockInTime",r.value),localStorage.setItem("clockInTime",r.value),l.value=Re()(a.value).add(1,"day").format("YYYY-MM-DD 05:00:00"),e.commit("setClockedIn",!0),localStorage.setItem("clockedIn",!0);try{const{data:t}=await Le.postAttendance({UserId:e.getters.userId,date:a.value,clockIn:r.value});await f(t.message,t.status)}catch(t){await f(t.message,"error")}finally{i.value=!1,u.value=!1}}async function g(){i.value=!0,u.value=!0,d.value=!0,c.value=Re().utc().local().format("YYYY-MM-DD HH:mm:ss"),a.value=Re()().format("YYYY-MM-DD")+" 08:00:00",e.commit("setClockOutTime",c.value),localStorage.setItem("clockOutTime",c.value),d.value=!0,e.commit("setClockedIn",!0),localStorage.setItem("clockedIn",!0);try{const{data:t}=await Le.updateAttendance({UserId:e.getters.userId,date:a.value,clockOut:c.value});await f(t.message,t.status)}catch(t){await f(t.message,"error")}finally{i.value=!1,u.value=!1}}async function f(e,t){"error"===t?Y.FN.fire({icon:"warning",title:e}):"success"===t&&Y.FN.fire({icon:"success",title:e})}return m(),setInterval((()=>{t.value=Re().utc().local().format("YYYY-MM-DD HH:mm:ss"),i.value=!1,Re()(t.value).isAfter(l.value)&&(c.value="",d.value=!1,e.commit("setClockedIn",!1),localStorage.removeItem("clockedIn"),localStorage.removeItem("clockInTime"),localStorage.removeItem("clockOutTime"),localStorage.removeItem("dayChangeTime"),localStorage.removeItem("date"))}),1e3),{currentTime:t,dayChangeTime:l,clockInTime:r,clockOutTime:c,clockIn:p,clockOut:g,clockedIn:d,isLoading:i,isProcessing:u}}};const Je=(0,_.Z)($e,[["render",ze]]);var Be=Je,Ke={name:"ClockPage",components:{AsideTabs:ge,ClockingView:Be}};const Xe=(0,_.Z)(Ke,[["render",oe]]);var et=Xe;const tt={class:"row vh-100",style:{"margin-top":"110px"}},at={class:"col-xl-10 col-md-10 col-10 mt-5 text-center"},nt={class:"container-field card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"1000px","margin-left":"55px","margin-right":"55px"}},ot=(0,o._)("div",{class:"d-flex justify-content-center text-center text-primary mb-4"},[(0,o._)("i",{class:"fa-solid fa-qrcode fa-3x m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," QRCode Page ")])],-1),st={key:0},rt=(0,o._)("a",{href:"#/clocking/qrcode/generator"},"QR Generator",-1),ct=(0,o._)("a",{href:"#/clocking/qrcode/read"},"QR Reader",-1);function lt(e,t,a,n,s,r){const c=(0,o.up)("AsideTabs"),l=(0,o.up)("AppSpinner");return(0,o.wg)(),(0,o.iD)("div",tt,[(0,o.Wm)(c,{class:"h-100"}),(0,o._)("div",at,[(0,o._)("div",nt,[n.isLoading?((0,o.wg)(),(0,o.j4)(l,{key:0})):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[ot,"admin"===n.currentUser.role?((0,o.wg)(),(0,o.iD)("div",st,[rt,(0,o.Uk)(" | "),ct])):(0,o.kq)("",!0),((0,o.wg)(),(0,o.j4)((0,o.LL)(n.currentView)))],64))])])])}const it={class:"container qrcode-generator",style:{width:"500px",height:"500px"}},ut=(0,o._)("br",null,null,-1);function dt(e,t,a,n,s,r){const c=(0,o.up)("qrcode-vue");return(0,o.wg)(),(0,o.iD)("div",it,[(0,o.Wm)(c,{value:n.value,size:n.size,class:"m-auto",style:{"padding-top":"50px"}},null,8,["value","size"]),ut])}a(2801);var mt=a(85);Re().extend(Ve(),Ge());var pt={components:{QrcodeVue:mt.Z},setup(){const e=(0,y.oR)(),t=localStorage.getItem("date"),a=(0,J.iH)(t);let n=(0,J.qj)({date:null}),o=(0,J.iH)("hr:defaultdata.random"),s=(0,J.iH)(500);a.value=Re().utc().local().format("YYYY-MM-DD 08:00:00"),localStorage.setItem("date",a.value),n={UserId:e.getters.userId,date:a.value};const r=btoa(JSON.stringify(n)),c=encodeURIComponent(r);return o.value=c,{value:o,size:s}}};const gt=(0,_.Z)(pt,[["render",dt]]);var ft=gt;const vt={class:"container qrcode-reader",style:{width:"500px",height:"500px"}},bt=(0,o._)("br",null,null,-1),ht=(0,o._)("p",null,"請開啟攝像頭！",-1);function wt(e,t,a,n,s,r){const c=(0,o.up)("qrcode-stream");return(0,o.wg)(),(0,o.iD)("div",vt,[bt,ht,(0,o._)("p",null,(0,l.zw)(n.errorText),1),(0,o.Wm)(c,{onInit:n.onInit,onDecode:n.onDecode},null,8,["onInit","onDecode"])])}var yt=a(2669);Re().extend(Ve(),Ge());var kt={name:"QRReader",components:{QrcodeStream:yt.QrcodeStream},setup(){const e=(0,y.oR)(),t=localStorage.getItem("clockedIn"),a=localStorage.getItem("clockInTime"),n=localStorage.getItem("clockOutTime"),o=localStorage.getItem("dayChangeTime"),s=(0,Y.uA)(t,e.state.clockedIn),r=(0,J.iH)(s),c=(0,J.iH)(a),l=(0,J.iH)(n),i=(0,J.iH)(o);let u=(0,J.iH)("");const d=(0,J.qj)({data:null,hasScanned:!1}),m=async t=>{try{const a=Re().utc().local().format("YYYY-MM-DD HH:mm:ss"),n=Re().utc().local().format("YYYY-MM-DD HH:mm:ss"),o=t.date,s=t.UserId;if(i.value=Re()(o).add(1,"day").format("YYYY-MM-DD 05:00:00"),d.hasScanned||r.value){l.value=n,(!l.value||Re().utc().local()>l.value)&&(l.value=Re().utc().local(),r.value=!0,e.commit("setClockedIn",!0),localStorage.setItem("clockedIn",!0));const{data:t}=await Le.updateAttendance({date:o,UserId:s,clockOut:n});Y.FN.fire({icon:"success",title:t.message}),e.commit("setClockOutTime",l.value),localStorage.setItem("clockOutTime",l.value)}else{e.commit("setClockedIn",!0),localStorage.setItem("clockedIn",!0);const{data:t}=await Le.postAttendance({UserId:s,date:o,clockIn:a});Y.FN.fire({icon:"success",title:t.message}),c.value=a,localStorage.setItem("clockInTime",a),localStorage.setItem("dayChangeTime",i),d.hasScanned=!0}}catch(a){Y.FN.fire({icon:"error",title:a.message})}},p=e=>{d.data=e;const t=JSON.parse(atob(decodeURIComponent(e)));m(t)},g=async e=>{try{const{capabilities:t}=await e;console.log(t)}catch(t){let e=(0,J.iH)("");switch(t.name){case"NotAllowedError":e.value="請允許使用攝影機功能！";break;case"NotFoundError":e.value="沒有安裝合適的攝像頭設備！";break;case"NotSupportedError":e.value="瀏覽器尚未通過 HTTPS(或本地主機)！";break;case"NotReadableError":e.value="請確認相機是否正在使用中！";break;case"OverconstrainedError":e.value="請確認是否有前置攝像頭！";break;case"StreamApiNotSupportedError":e.value="瀏覽器似乎缺少功能！";break}}};return{onDecode:p,onInit:g,errorText:u}}};const xt=(0,_.Z)(kt,[["render",wt]]);var _t=xt,It={name:"QRCodePage",components:{AsideTabs:ge,AppSpinner:Ze},setup(){const e=(0,y.oR)(),t=(0,y.rn)(["currentUser"]),a={},n=(0,J.iH)(!0);Object.keys(t).map((n=>{const s=t[n];a[n]=(0,o.Fl)(s.bind({$store:e}))}));const{currentUser:s}={...a},r={"/clocking/qrcode/generator":ft,"/clocking/qrcode/read":_t},c=(0,J.iH)(window.location.hash);window.addEventListener("hashchange",(()=>{c.value=window.location.hash}));const l=(0,o.Fl)((()=>r[c.value.slice(1)||"/"]||"NotFound"));return n.value=!1,{currentView:l,isLoading:n,currentUser:s}}};const Dt=(0,_.Z)(It,[["render",lt]]);var At=Dt;const St={class:"row vh-100",style:{"margin-top":"110px"}},Tt={class:"col-xl-10 col-md-10 col-10 mt-5 text-center"},Yt={class:"container-field card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"1000px","margin-left":"55px","margin-right":"55px"}},Ct=(0,o._)("div",{class:"d-flex justify-content-center text-center text-primary mb-4"},[(0,o._)("i",{class:"fa-solid fa-location-dot fa-3x m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," GPS Page ")])],-1);function Ht(e,t,a,n,s,r){const c=(0,o.up)("AsideTabs"),l=(0,o.up)("GPSMap");return(0,o.wg)(),(0,o.iD)("div",St,[(0,o.Wm)(c,{class:"h-100"}),(0,o._)("div",Tt,[(0,o._)("div",Yt,[Ct,(0,o.Wm)(l)])])])}const Ut={key:1,class:"my-3 d-grid gap-2 col-4 mx-auto"},zt=["disabled"],Pt=(0,o._)("h3",{class:"mb-0"},"打卡上班",-1),Ot=[Pt],Mt=["disabled"],jt=(0,o._)("h3",{class:"mb-0"},"打卡下班",-1),Nt=[jt],Ft={class:"my-3 card d-flex justify-content-between align-items-center",style:{border:"none"}},qt={class:"text-primary"},Zt={key:0,class:"text-danger"},Lt={id:"map",ref:"mapContainer",class:"m-auto",style:{width:"50vh",height:"50vh"}};function Et(e,t,a,n,s,r){const c=(0,o.up)("AppSpinner");return(0,o.wg)(),(0,o.iD)("div",null,[n.isLoading?((0,o.wg)(),(0,o.j4)(c,{key:0},{default:(0,o.w5)((()=>[(0,o.Uk)("允許取得位置後，才能進行GPS打卡！")])),_:1})):((0,o.wg)(),(0,o.iD)("div",Ut,[n.clockedIn?n.clockedIn?((0,o.wg)(),(0,o.iD)("button",{key:1,disabled:!n.withinRange,onClick:t[1]||(t[1]=(...e)=>n.clockOut&&n.clockOut(...e)),class:"btn btn-success btn-circle"},Nt,8,Mt)):(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("button",{key:0,disabled:!n.withinRange,onClick:t[0]||(t[0]=(...e)=>n.clockIn&&n.clockIn(...e)),class:"btn btn-danger btn-circle"},Ot,8,zt)),(0,o._)("div",Ft,[(0,o._)("h3",qt,"目前距離公司還有"+(0,l.zw)(n.distance)+"公尺。",1),n.withinRange?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("h3",Zt,"超出範圍，無法打卡！"))])])),(0,o._)("div",Lt,null,512)])}var Rt=a(3153),Wt=a.n(Rt),Vt=a(7093),Qt=a(8858);Re().extend(Ve(),Ge());var Gt={name:"GPSMap",components:{AppSpinner:Ze},setup(){const e=(0,J.iH)("map"),t=(0,J.iH)({lat:"",long:""}),a={lat:25.04211400258323,long:121.5329032921531},n=(0,J.iH)("?"),s=(0,J.iH)(!1),r=(0,J.iH)(!0);(0,o.bv)((async()=>{await new Promise((e=>{navigator.geolocation.getCurrentPosition((a=>{t.value.lat=a.coords.latitude,t.value.long=a.coords.longitude,e()}),(e=>{console.error(e)}),{enableHighAccuracy:!0})}));const o=Wt().map(e.value,{center:[t.value.lat,t.value.long],zoom:8});Wt().tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(o);const c=new(Wt().Icon)({iconUrl:Vt,shadowUrl:Qt,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});var l=Wt().circle([a.lat,a.long],{color:"blue",fillColor:"#6495ED",fillOpacity:.5,radius:500}).addTo(o);Wt().marker([a.lat,a.long],{icon:c}).addTo(o),Wt().marker([t.value.lat,t.value.long],{icon:c}).addTo(o);let i=Wt().latLng(t.value.lat,t.value.long),u=Wt().latLng(a.lat,a.long);return n.value=i.distanceTo(u).toFixed(),s.value=n.value<400,r.value=!1,{currentPosition:t,distance:n,circle:l,isLoading:r}}));const c=(0,y.oR)(),l=(0,J.iH)(Re()().format("YYYY-MM-DD")),i=localStorage.getItem("dayChangeTime"),u=localStorage.getItem("clockedIn"),d=localStorage.getItem("clockInTime"),m=localStorage.getItem("clockOutTime"),p=(0,Y.uA)(u,c.state.clockedIn),g=(0,J.iH)(d),f=(0,J.iH)(m),v=(0,J.iH)(i),b=(0,J.iH)(!1),h=(0,J.iH)(p);async function w(){r.value=!0,b.value=!0,h.value=!0,g.value=Re().utc().local().format("YYYY-MM-DD HH:mm:ss"),c.commit("setClockInTime",g.value),localStorage.setItem("clockInTime",g.value),v.value=Re()(l.value).add(1,"day").format("YYYY-MM-DD 05:00:00"),c.commit("setClockedIn",!0),localStorage.setItem("clockedIn",!0);try{const{data:e}=await Le.postAttendance({UserId:c.getters.userId,date:l.value,clockIn:g.value});await x(e.message,e.status),r.value=!1,b.value=!1}catch(e){r.value=!1,await x(e.message,"error")}finally{r.value=!1,b.value=!1}}async function k(){r.value=!0,b.value=!0,h.value=!0,f.value=Re().utc().local().format("YYYY-MM-DD HH:mm:ss"),l.value=Re()().format("YYYY-MM-DD")+" 08:00:00",c.commit("setClockOutTime",f.value),localStorage.setItem("clockOutTime",f.value),h.value=!0,c.commit("setClockedIn",!0),localStorage.setItem("clockedIn",!0);try{const{data:e}=await Le.updateAttendance({UserId:c.getters.userId,date:l.value,clockOut:f.value});await x(e.message,e.status),r.value=!1,b.value=!1}catch(e){r.value=!1,await x(e.message,"error")}finally{r.value=!1,b.value=!1}}async function x(e,t){"error"===t?Y.FN.fire({icon:"warning",title:e}):"success"===t&&Y.FN.fire({icon:"success",title:e})}return{distance:n,withinRange:s,isLoading:r,clockIn:w,clockOut:k,clockedIn:h}}};const $t=(0,_.Z)(Gt,[["render",Et]]);var Jt=$t,Bt={name:"GPSPage",components:{AsideTabs:ge,GPSMap:Jt}};const Kt=(0,_.Z)(Bt,[["render",Ht]]);var Xt=Kt;const ea={class:"row vh-100",style:{"margin-top":"110px"}},ta={class:"col-xl-10 col-md-10 col-10 mt-5 text-center"},aa={class:"container-field card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"1000px","margin-left":"55px","margin-right":"55px"}};function na(e,t,a,n,s,r){const c=(0,o.up)("AsideTabs"),l=(0,o.up)("ProfileTable");return(0,o.wg)(),(0,o.iD)("div",ea,[(0,o.Wm)(c,{class:"h-100"}),(0,o._)("div",ta,[(0,o._)("div",aa,[(0,o.Wm)(l)])])])}const oa=(0,o._)("div",{class:"d-flex justify-content-center text-center mb-4"},[(0,o._)("i",{class:"fa-solid fa-address-card fa-3x m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," Profile Page ")])],-1),sa={class:"form-label-group m-auto text-muted text-start mb-2",style:{width:"400px","font-size":"24px"}},ra=(0,o._)("label",{for:"name"},[(0,o._)("strong",null," Name ")],-1),ca={class:"form-label-group m-auto text-muted text-start mb-2",style:{width:"400px","font-size":"24px"}},la=(0,o._)("label",{for:"email"},[(0,o._)("strong",null," Email ")],-1),ia={class:"form-label-group m-auto text-muted text-start mb-2",style:{width:"400px","font-size":"24px"}},ua=(0,o._)("label",{for:"account"},[(0,o._)("strong",null," Account ")],-1),da={class:"form-label-group m-auto text-muted text-start mb-3",style:{width:"400px","font-size":"24px"}},ma=(0,o._)("label",{for:"password"},[(0,o._)("strong",null," Password ")],-1),pa={class:"form-label-group m-auto text-muted text-start mb-3",style:{width:"400px","font-size":"24px"}},ga=(0,o._)("label",{for:"password-check"},[(0,o._)("strong",null," Password Check ")],-1),fa={class:"d-flex justify-content-center p-0",style:{"margin-top":"50px"}},va=["disabled"];function ba(e,t,a,s,r,c){return(0,o.wg)(),(0,o.iD)("form",{class:"w-50 text-primary m-auto",onSubmit:t[5]||(t[5]=(0,n.iM)(((...e)=>s.handleSubmit&&s.handleSubmit(...e)),["prevent","stop"]))},[oa,(0,o._)("div",sa,[ra,(0,o.wy)((0,o._)("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>s.userForm.name=e),name:"name",type:"text",class:"form-control",placeholder:"name",autocomplete:"username",required:"",autofocus:""},null,512),[[n.nr,s.userForm.name]])]),(0,o._)("div",ca,[la,(0,o.wy)((0,o._)("input",{id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>s.userForm.email=e),name:"email",type:"email",class:"form-control",placeholder:"email",autocomplete:"email",required:""},null,512),[[n.nr,s.userForm.email]])]),(0,o._)("div",ia,[ua,(0,o.wy)((0,o._)("input",{id:"account","onUpdate:modelValue":t[2]||(t[2]=e=>s.userForm.account=e),name:"account",type:"text",class:"form-control",placeholder:"account",autocomplete:"username",required:""},null,512),[[n.nr,s.userForm.account]])]),(0,o._)("div",da,[ma,(0,o.wy)((0,o._)("input",{id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>s.userForm.password=e),name:"password",type:"password",class:"form-control",placeholder:"password",autocomplete:"new-password",required:""},null,512),[[n.nr,s.userForm.password]])]),(0,o._)("div",pa,[ga,(0,o.wy)((0,o._)("input",{id:"password-check","onUpdate:modelValue":t[4]||(t[4]=e=>s.userForm.passwordCheck=e),name:"passwordCheck",type:"password",class:"form-control",placeholder:"password check",autocomplete:"new-password",required:""},null,512),[[n.nr,s.userForm.passwordCheck]])]),(0,o._)("div",fa,[(0,o._)("button",{class:"btn btn-lg btn-primary btn-block mb-3",type:"submit",disabled:s.isProcessing,style:{"font-size":"24px",width:"200px"}},[(0,o._)("strong",null,(0,l.zw)(s.isProcessing?"Processing...":"Change"),1)],8,va)])],32)}var ha={name:"ProfileTable",setup(){const e=(0,k.tv)(),t=(0,y.oR)(),a=(0,J.iH)(!1),n=(0,J.qj)({name:"",email:"",account:"",password:"",passwordCheck:""});async function o(){const e=t.getters.userId,a=await C.getCurrentUser(e);n.name=a.data.name,n.email=a.data.email,n.account=a.data.account}async function s(){a.value=!0;try{const o=await C.putProfile({UserId:t.getters.userId,formData:n});if("error"===o.status)throw new Error(o.message);Y.FN.fire({icon:"success",title:"更新成功！"}),e.push(`/clocking/user/${t.getters.userId}`).then((()=>{a.value=!1,location.reload()}))}catch(o){Y.FN.fire({icon:"error",title:"無法更新使用者資料，請稍後再試！"}),a.value=!1}}return o(),{userForm:n,isProcessing:a,handleSubmit:s}}};const wa=(0,_.Z)(ha,[["render",ba]]);var ya=wa,ka={name:"ProfilePage",components:{AsideTabs:ge,ProfileTable:ya}};const xa=(0,_.Z)(ka,[["render",na]]);var _a=xa;const Ia={class:"row vh-100",style:{"margin-top":"110px"}},Da={class:"col-xl-10 col-md-10 col-10 mt-5 text-center"},Aa={class:"container-field card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"1000px","margin-left":"55px","margin-right":"55px"}},Sa=(0,o._)("div",{class:"d-flex justify-content-center text-center text-primary"},[(0,o._)("i",{class:"fa-solid fa-chart-column fa-3x m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," Admin Page ")])],-1);function Ta(e,t,a,n,s,r){const c=(0,o.up)("AdminAsideTabs"),l=(0,o.up)("AdminDashboard");return(0,o.wg)(),(0,o.iD)("div",Ia,[(0,o.Wm)(c,{class:"h-100"}),(0,o._)("div",Da,[(0,o._)("div",Aa,[Sa,(0,o.Wm)(l)])])])}const Ya={class:"col-xl-2 col-md-2 col-2 text-center",style:{"background-color":"#14597f"}},Ca={class:"navbar-nav p-0"},Ha={class:"title"},Ua={class:"fontawesome text-center m-auto",style:{width:"150px"}},za={class:"fs-4 m-1"};function Pa(e,t,a,n,s,r){const c=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("aside",Ya,[(0,o._)("ul",Ca,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.tabs,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.id,class:"nav-item text-white m-4",style:{"text-decoration":"none"}},[(0,o.Wm)(c,{to:e.path,class:"nav-link d-flex justify-content-between"},{default:(0,o.w5)((()=>[(0,o._)("div",Ha,[(0,o._)("i",{class:(0,l.C_)(e.fontawesome),style:{width:"100px"}},null,2)]),(0,o._)("div",Ua,[(0,o._)("strong",za,(0,l.zw)(e.title),1)])])),_:2},1032,["to"])])))),128))])])}var Oa={setup(){const e=(0,J.qj)([{id:(0,de.Z)(),title:"Administration",path:"/admin/attendance/dashboard",fontawesome:"fa-solid fa-chart-column fa-3x"},{id:(0,de.Z)(),title:"UsersList",path:"/admin/attendance/users",fontawesome:"fa-solid fa-users fa-3x"},{id:(0,de.Z)(),title:"AbsentList",path:"/admin/attendance/absent",fontawesome:"fa-solid fa-list-check fa-3x"}]);return{tabs:e}}};const Ma=(0,_.Z)(Oa,[["render",Pa]]);var ja=Ma;const Na={key:1,class:"container d-flex justify-content-around mb-3"},Fa={class:"col-md-6"},qa=(0,o._)("h2",{class:"text-center mb-3"},"Attendance Trend 2023",-1),Za={ref:"barChart",style:{"margin-top":"100px",transform:"scale(1.5)"}};function La(e,t,a,n,s,r){const c=(0,o.up)("AppSpinner");return n.isLoading?((0,o.wg)(),(0,o.j4)(c,{key:0})):((0,o.wg)(),(0,o.iD)("div",Na,[(0,o._)("div",Fa,[qa,(0,o._)("canvas",Za,null,512)])]))}var Ea=a(1632),Ra={attendance:{getAttendance(){return Y.l9.get("/admin/attendance")},getDashboard(){return Y.l9.get("/admin/attendance/dashboard")}},users:{getUsers(){return Y.l9.get("/admin/attendance/users")},putIsLocked(e){return Y.l9.put(`/admin/attendance/users/${e}`,{userId:e})}},absent:{putAbsent(e){return Y.l9.put(`/admin/attendance/${e}`,{attendanceId:e})}}},Wa={name:"AdminDashboard",components:{AppSpinner:Ze},setup(){const e=(0,J.iH)(null),t=(0,J.iH)([]),a=(0,J.iH)([]),n=(0,J.iH)(!0);async function s(){try{const{data:e}=await Ra.attendance.getDashboard();t.value=e.attendances,a.value=e.absences,n.value=!1}catch(e){Y.FN.fire({icon:"error",title:"無法取得打卡趨勢圖！"}),n.value=!1}}return(0,o.bv)((async()=>{await s();const n=e.value.getContext("2d");new Ea.ZP(n,{data:{labels:["January","February","March","April","May","June","July","August","September","October","November","December"],datasets:[{type:"bar",label:"Attendances",stack:"Stack 1",data:t.value,backgroundColor:["rgba(54, 162, 235, 0.2)"],borderColor:["rgb(54, 162, 235)"],borderWidth:1},{type:"bar",label:"Absences",stack:"Stack 1",data:a.value,backgroundColor:["rgba(255, 99, 132, 0.2)"],borderColor:["rgb(255, 99, 132)"],borderWidth:1}]},options:{}})})),{barChart:e,isLoading:n}}};const Va=(0,_.Z)(Wa,[["render",La]]);var Qa=Va,Ga={components:{AdminAsideTabs:ja,AdminDashboard:Qa}};const $a=(0,_.Z)(Ga,[["render",Ta]]);var Ja=$a;const Ba={class:"row vh-100",style:{"margin-top":"110px"}},Ka={class:"col-xl-10 col-md-10 col-10 mt-5 text-center"},Xa={class:"container-field card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"1000px","margin-left":"55px","margin-right":"55px"}},en=(0,o._)("div",{class:"d-flex justify-content-center text-center text-primary mb-4"},[(0,o._)("i",{class:"fa-solid fa-users fa-3x m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," Users Page ")])],-1);function tn(e,t,a,n,s,r){const c=(0,o.up)("AdminAsideTabs"),l=(0,o.up)("AdminUserTable");return(0,o.wg)(),(0,o.iD)("div",Ba,[(0,o.Wm)(c,{class:"h-100"}),(0,o._)("div",Ka,[(0,o._)("div",Xa,[en,(0,o.Wm)(l)])])])}const an={key:1,class:"table table-hover table-bordered text-center"},nn=(0,o._)("thead",{class:"table-light"},[(0,o._)("tr",{class:"table-info",style:{"font-size":"24px"}},[(0,o._)("th",{scope:"col"},"ID"),(0,o._)("th",{scope:"col"},"Name"),(0,o._)("th",{scope:"col"},"Email"),(0,o._)("th",{scope:"col"},"Role"),(0,o._)("th",{scope:"col"},"Is Locked"),(0,o._)("th",{scope:"col"},"Button")])],-1),on={scope:"row"},sn=["onClick","disabled"];function rn(e,t,a,n,s,r){const c=(0,o.up)("AppSpinner");return n.isLoading?((0,o.wg)(),(0,o.j4)(c,{key:0})):((0,o.wg)(),(0,o.iD)("table",an,[nn,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.users,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id,style:{"font-size":"20px"}},[(0,o._)("td",on,(0,l.zw)(e.id),1),(0,o._)("td",null,(0,l.zw)(e.name),1),(0,o._)("td",null,(0,l.zw)(e.email),1),(0,o._)("td",null,(0,l.zw)(e.role),1),(0,o._)("td",null,(0,l.zw)(e.isLocked?"Yes":"No"),1),(0,o._)("td",null,[e.isLocked?((0,o.wg)(),(0,o.iD)("button",{key:0,class:"btn btn-danger btn-sm",onClick:t=>n.putIsLocked(e),disabled:n.isProcessing}," None IsLocked ",8,sn)):(0,o.kq)("",!0)])])))),128))])]))}var cn={name:"AdminUserTable",components:{AppSpinner:Ze},setup(){const e=(0,k.tv)(),t=(0,J.iH)([]),a=(0,J.iH)(!1),n=(0,J.iH)(!1);async function o(){a.value=!0,n.value=!0;try{const{data:e}=await Ra.users.getUsers();if("error"===e.status)throw new Error(e.message);t.value=e,a.value=!1,n.value=!1}catch(e){Y.FN.fire({icon:"error",title:"無法取得人員清單！"}),a.value=!1,n.value=!1}}async function s(t){a.value=!0,n.value=!0;try{const{data:o}=await Ra.users.putIsLocked(t.id);if("error"===o.status)throw new Error(o.message);"success"===o.status&&Y.FN.fire({icon:"success",title:o.message}),e.push("/admin/attendance/users").then((()=>{a.value=!1,n.value=!1,location.reload()}))}catch(o){Y.FN.fire({icon:"error",title:o.response.data.message}),a.value=!1,n.value=!1}}return o(),{users:t,putIsLocked:s,isLoading:a,isProcessing:n}}};const ln=(0,_.Z)(cn,[["render",rn]]);var un=ln,dn={components:{AdminAsideTabs:ja,AdminUserTable:un}};const mn=(0,_.Z)(dn,[["render",tn]]);var pn=mn;const gn={class:"row vh-100",style:{"margin-top":"110px"}},fn={class:"col-xl-10 col-md-10 col-10 mt-5 text-center"},vn={class:"container-field card d-flex justify-content-center shadow p-3 mb-5 bg-body rounded",style:{height:"1000px","margin-left":"55px","margin-right":"55px"}},bn=(0,o._)("div",{class:"d-flex justify-content-center text-center text-primary mb-4"},[(0,o._)("i",{class:"fa-solid fa-list-check fa-3x m-3"}),(0,o._)("p",{class:"mb-3 font-weight-normal",style:{"font-size":"48px"}},[(0,o._)("strong",null," Absent Page ")])],-1);function hn(e,t,a,n,s,r){const c=(0,o.up)("AdminAsideTabs"),l=(0,o.up)("AdminAsbentTable");return(0,o.wg)(),(0,o.iD)("div",gn,[(0,o.Wm)(c,{class:"h-100"}),(0,o._)("div",fn,[(0,o._)("div",vn,[bn,(0,o.Wm)(l)])])])}const wn={key:1,class:"table table-hover table-bordered text-center"},yn=(0,o._)("thead",{class:"table-light"},[(0,o._)("tr",{class:"table-primary",style:{"font-size":"24px"}},[(0,o._)("th",{scope:"col"},"ID"),(0,o._)("th",{scope:"col"},"Name"),(0,o._)("th",{scope:"col"},"Date"),(0,o._)("th",{scope:"col"},"ClockInTime"),(0,o._)("th",{scope:"col"},"ClockOutTime"),(0,o._)("th",{scope:"col"},"ElapsedTime(hr)"),(0,o._)("th",{scope:"col"},"Absent"),(0,o._)("th",{scope:"col"},"Button")])],-1),kn=["onClick","disabled"];function xn(e,t,a,n,s,r){const c=(0,o.up)("AppSpinner");return n.isLoading?((0,o.wg)(),(0,o.j4)(c,{key:0})):((0,o.wg)(),(0,o.iD)("table",wn,[yn,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.attendances,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id,style:{"font-size":"20px"}},[(0,o._)("td",null,(0,l.zw)(e.id),1),(0,o._)("td",null,(0,l.zw)(e.User.name),1),(0,o._)("td",null,(0,l.zw)(e.date),1),(0,o._)("td",null,(0,l.zw)(e.clockIn),1),(0,o._)("td",null,(0,l.zw)(e.clockOut),1),(0,o._)("td",null,(0,l.zw)(e.elapsedTime),1),(0,o._)("td",null,(0,l.zw)(e.absent?"Yes":"No"),1),(0,o._)("td",null,[e.absent?((0,o.wg)(),(0,o.iD)("button",{key:0,class:"btn btn-danger btn-sm",onClick:t=>n.putAbsent(e),disabled:n.isProcessing}," None Absence ",8,kn)):(0,o.kq)("",!0)])])))),128))])]))}Re().extend(Ve(),Ge());var _n={name:"AdminAsbentTable",components:{AppSpinner:Ze},setup(){const e=(0,k.tv)(),t=(0,J.iH)([]),a=(0,J.iH)(!1),n=(0,J.iH)(!1);async function o(){try{a.value=!0,n.value=!0;const{data:e}=await Ra.attendance.getAttendance();if("error"===e.status)throw new Error(e.message);for(let t=0;t<e.length;t++)e[t].date=Re()(e[t].date).format("YYYY-MM-DD"),e[t].clockIn=Re()(e[t].clockIn).format("YYYY-MM-DD HH:mm:ss"),e[t].clockOut=Re()(e[t].clockOut).format("YYYY-MM-DD HH:mm:ss"),e[t].elapsedTime=e[t].elapsedTime?Re().utc(e[t].elapsedTime).format("HH:mm:ss"):null,"Invalid Date"===e[t].clockOut&&(e[t].clockOut="-",e[t].elapsedTime="-");t.value=e,a.value=!1,n.value=!1}catch(e){Y.FN.fire({icon:"error",title:"無法取得打卡清單！"}),a.value=!1,n.value=!1}}function s(e){return Re().tz(e,"Asia/Taipei").format("YYYY-MM-DD HH:mm:ss")}function r(e){return Re().tz(e,"Asia/Taipei").format("YYYY-MM-DD HH:mm:ss")}async function c(t){a.value=!0,n.value=!0;try{const{data:o}=await Ra.absent.putAbsent(t.id);if("error"===o.status)throw new Error(o.message);"success"===o.status&&Y.FN.fire({icon:"success",title:o.message}),e.push("/admin/attendance/absent").then((()=>{a.value=!1,n.value=!1,location.reload()}))}catch(o){Y.FN.fire({icon:"error",title:o.response.data.message}),a.value=!1,n.value=!1}}return o(),{attendances:t,formattedClockIn:s,formattedClockOut:r,putAbsent:c,isLoading:a,isProcessing:n}}};const In=(0,_.Z)(_n,[["render",xn]]);var Dn=In,An={components:{AdminAsideTabs:ja,AdminAsbentTable:Dn}};const Sn=(0,_.Z)(An,[["render",hn]]);var Tn=Sn;const Yn=(e,t,a)=>{const n=H.state.currentUser;n&&"admin"!==n.role?a("/not-found"):a()},Cn=[{path:"/",name:"root",component:et},{path:"/signin",name:"sign-in",component:ee},{path:"/signup",name:"sign-up",component:()=>a.e(839).then(a.bind(a,839))},{path:"/clocking",name:"clocking",component:et},{path:"/clocking/qrcode/generator",name:"clocking-generator",component:At},{path:"/clocking/qrcode/read",name:"clocking-read",component:At},{path:"/clocking/gps",name:"clocking-gps",component:Xt},{path:"/clocking/user/:id/edit",name:"clocking-profile",component:_a},{path:"/clocking/user/:id",name:"clocking-profile",component:_a},{path:"/admin",exact:!0,redirect:"/admin/attendance/dashboard"},{path:"/admin/attendance/dashboard",name:"admin-attendance",component:Ja,beforeEnter:Yn},{path:"/admin/attendance/users",name:"admin-users",component:pn,beforeEnter:Yn},{path:"/admin/attendance/absent",name:"admin-absent",component:Tn,beforeEnter:Yn},{path:"/:pathMatch(.*)*",name:"not-found",component:O}],Hn=(0,k.p7)({history:(0,k.r5)(),routes:Cn});Hn.beforeEach((async(e,t,a)=>{const n=localStorage.getItem("token"),o=H.state.token;let s=H.state.isAuthenticated;n&&n!==o&&(s=await H.dispatch("fetchCurrentUser"));const r=["sign-up","sign-in"];s||r.includes(e.name)?s&&r.includes(e.name)?a("/clocking"):a():a("/signin")}));var Un=Hn;a(2166),a(1129);(0,n.ri)(T).use(H).use(Un).mount("#app")},6163:function(e,t,a){a.d(t,{FN:function(){return u},l9:function(){return i},uA:function(){return d}});var n=a(6265),o=a.n(n),s=a(2492),r=a.n(s);const c="https://attendance-management-platform.herokuapp.com/api",l=o().create({baseURL:c});l.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e)));const i=l,u=r().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3}),d=(e,t)=>{let a=null;if(e&&null!==e)try{a=JSON.parse(e)}catch(n){console.error(n),a=t}else a=t;return a}}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,s){if(!n){var r=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],s=e[u][2];for(var c=!0,l=0;l<n.length;l++)(!1&s||r>=s)&&Object.keys(a.O).every((function(e){return a.O[e](n[l])}))?n.splice(l--,1):(c=!1,s<r&&(r=s));if(c){e.splice(u--,1);var i=o();void 0!==i&&(t=i)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,o,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,n){return a.f[n](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+".94edd8b0.js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="frontend:";a.l=function(n,o,s,r){if(e[n])e[n].push(o);else{var c,l;if(void 0!==s)for(var i=document.getElementsByTagName("script"),u=0;u<i.length;u++){var d=i[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+s){c=d;break}}c||(l=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,a.nc&&c.setAttribute("nonce",a.nc),c.setAttribute("data-webpack",t+s),c.src=n),e[n]=[o];var m=function(t,a){c.onerror=c.onload=null,clearTimeout(p);var o=e[n];if(delete e[n],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach((function(e){return e(a)})),t)return t(a)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=m.bind(null,c.onerror),c.onload=m.bind(null,c.onload),l&&document.head.appendChild(c)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/attendance-management-platform-api/"}(),function(){var e={143:0};a.f.j=function(t,n){var o=a.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var s=new Promise((function(a,n){o=e[t]=[a,n]}));n.push(o[2]=s);var r=a.p+a.u(t),c=new Error,l=function(n){if(a.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var s=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;c.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",c.name="ChunkLoadError",c.type=s,c.request=r,o[1](c)}};a.l(r,l,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,s,r=n[0],c=n[1],l=n[2],i=0;if(r.some((function(t){return 0!==e[t]}))){for(o in c)a.o(c,o)&&(a.m[o]=c[o]);if(l)var u=l(a)}for(t&&t(n);i<r.length;i++)s=r[i],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(u)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(292)}));n=a.O(n)})();
//# sourceMappingURL=app.8869a3a4.js.map